---
title: "36-315 Homework 09, Fall 2017"
author: "Your Group Number, Group Member Names, and Group Member AndrewIDs Here o "
date: "Due Thursday, Thursday 9th, 2017 (11:59pm ET) on Canvas"
output: 
  html_document:
    toc:  true
    toc_float:  true
    code_folding:  hide
---

##  Homework 09:  Networks, Variable Visualization, and New 1-D Graph Critiques

***
***

##  Important Note -- This Is A Group Assignment!

You should complete HW09 **as a group**.  Only one submission is needed per group.  Groups that submit multiple assignments may lose points at the instructors' discretion.


#  Problem 0

**Organization, Themes, and HTML Output**

(5 points)

a.  For all problems in this assignment, organize your output as follows:

+  Use code folding for all code.  See [here](http://blog.rstudio.org/2016/03/21/rmarkdown-v0-9-5/) for how to do this.
+  Use a floating table of contents.
+  Suppress all warning messages in your output by using `warning = FALSE` and `message = FALSE` in every code block.
+  Use tabs only if you see it fit to do so -- this is your choice.


b.  For all problems in this assignment, adhere to the following guidelines for your `ggplot` theme and use of color:

+  Do not use the default `ggplot()` color scheme.
+  For any bar chart or histogram, outline the bars (e.g. with `color = "black"`).
+  Do not use both red and green in the same plot, since a large proportion of the population is red-green colorblind.
+  Try to only use three colors (at most) in your themes.  In previous assignments, many students are using different colors for the axes, axis ticks, axis labels, graph titles, grid lines, background, etc.  This is unnecessary and only serves to make your graphs more difficult to read.  Use a more concise color scheme.
+  Make sure you use a white or gray background (preferably light gray if you use gray).
+  Make sure that titles, labels, and axes are in dark colors, so that they contrast well with the light colored background.
+  Only use color when necessary and when it enhances your graph.  For example, if you have a univariate bar chart, there's no need to color the bars different colors, since this is redundant.
+  In general, try to keep your themes (and written answers) professional.  Remember, you should treat these assignments as professional reports.


c.  Treat your submission as a formal report:

+  Use complete sentences when answering questions.  
+  Answer in the context of the problem.  
+  Treat your submission more as a formal "report", where you are providing details analyses to answer the research questions asked in the problems.


d.  What style guide are you using for this assignment?


***
***



#  Problem 3

(20 points)

**Variable Dendrograms**


```{r, warning = FALSE, message = FALSE}
library(tidyverse)
library("MASS")
```


a.  

```{r, warning = FALSE, message = FALSE, fig.height = 8, fig.width = 12}
# load dendextend
library(dendextend)

# only keep continuous variables
cars_cont <- subset(Cars93, select = -c(Manufacturer, Model, Type, AirBags,
                                        DriveTrain, Cylinders, Man.trans.avail, 
                                        Origin, Make, Rear.seat.room,
                                        Luggage.room))

# correlation matrix
cars_cor <- cor(cars_cont)

# positive values
cars_cor <- 1 - abs(cars_cor)

# dist matrix
cars_dist <- as.dist(cars_cor)

# hierarchical clustering
cars_hc <- hclust(cars_dist, method = "complete")

# convert to dendrogram
cars_dend <- as.dendrogram(cars_hc)

# plot dendgrogram
cars_dend %>% 
  set("labels", colnames(cars_cont), order_value = TRUE) %>%
  set("branches_k_color", k = 4) %>%
  ggplot(horiz = T) +
  labs(title = "Correlation between Continuous Variables in Cars93",
       x = "Make", 
       y = "Pairwise Euclidean Distance") +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_text(color = "black"),
        axis.text.x = element_text(color = "black", angle = 90))

```

b.  Passengers and RPM are in their own clusters, while all variables related to price and horsepower is in its own cluster.  This makes sense because all the price variables should be correlated and horsepower correlating with prices seem to be logical.  All the other variables relating to size, efficiency and revolutions per mile is in the final cluster.  This also makes sense logically because all size and efficiency variables should be correlated with other size and efficiency variables.  These observations are consistent with part f of problem 2.

c.  We could use the covariance between the continuous variables instead of the correlation.


***
***





#  Problem 4

(2 points each)

**_Love Actually_ Character Network**

a.  They plotted the social network between the characters by the number of scenes that the characters shared between one another.  They then use the edges to explain plot points that happen in the film. They also measured the number of different characters that a certain character has a conversation with to determine social activity.

b.  

```{r, warning = FALSE, message = FALSE, fig.height = 8, fig.width = 12}
# load forcats
library(forcats)

# read dataframe
love_adjacency <- read_csv("https://raw.githubusercontent.com/fivethirtyeight/data/master/love-actually/love_actually_adjacencies.csv")

# change category names
love_adjacency <- love_adjacency %>%
  mutate(actors = fct_recode(actors,
    "Bill Nighy" = "bill_nighy",
                           "Keira Knightley" = "keira_knightley",
                           "Andrew Lincoln" = "andrew_lincoln",
                           "Hugh Grant" = "hugh_grant",
                           "Colin Firth" = "colin_firth",
                           "Alan Rickman" = "alan_rickman",
                           "Heike Makatsch" = "heike_makatsch",
                           "Laura Linney" = "laura_linney",
                           "Emma Thompson" = "emma_thompson",
                           "Liam Neeson" = "liam_neeson",
                           "Kris Marshall" = "kris_marshall",
                           "Abdul Salis" = "abdul_salis",
                           "Martin Freeman" = "martin_freeman",
                           "Rowan Atkinson" = "rowan_atkinson"))

# distance matrix
love_dist <- 1 / (1 + as.dist(love_adjacency[,-1]))

# hierarchical clustering
love_hc <- hclust(love_dist, method = "average")

# convert to dendrogram
love_dend <- as.dendrogram(love_hc)

# plot dendrogram
love_dend %>% 
  set("labels", love_adjacency$actors, order_value = TRUE) %>%
  ggplot(horiz = T) +
  labs(title = "Adjacency of Actors in Love Actually", 
       y = "Pairwise Euclidean Distance") +
  theme(axis.title.y = element_blank(),
        axis.title.x = element_text(color = "black"),
        axis.text.x = element_text(color = "black", angle = 90))
```

c. Tony, Colin and John are connected; Mark, Juliet, Sarah and Jamie are connected; Daniel, Billy and the prime minister are connected; finally, Karen, Harry and Mia are connected.

d.  ggraph is an extension of ggplot mainly for networks and trees.  `ggraph()` is the equivalent of `ggplot()`.  It was released Feb 23, 2017.

e.  


```{r, warning = FALSE, message = FALSE}
# load ggraph
library(ggraph)

# plot dendrogram
ggraph(love_hc, layout = "dendrogram") +
  geom_edge_elbow() +
  labs(title = "Adjacency of Actors in Love Actually",
       x = "Actor",
       y = "Pairwise Euclidean Distance") +
  theme(axis.ticks = element_blank(),
        axis.text.x = element_blank())
```

f.  

```{r, warning = FALSE, message = FALSE}
# load igraph library
library(igraph)

# define names, graph (dist)
names <- love_adjacency[,1]
graph <- graph_from_adjacency_matrix(as.dist(love_adjacency[,-1]))

# plot network
ggraph(graph, layout = 'graphopt') + 
    geom_edge_link() +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text = element_blank())

```

g.  

```{r, fig.height = 8, fig.width = 12}
# change to circular, arcs and add text
ggraph(graph, layout = 'linear', circular = TRUE) + 
    geom_edge_arc() + 
    geom_node_text(aes(label = names)) +
  theme(axis.title = element_blank(),
        axis.ticks = element_blank(),
        axis.text = element_blank())
```

h.  (BONUS:  3 points)  Color the nodes of the graph by the gender of the actor/actress.  Facet on the gender of the actor/actress.



***
***